import{_ as s,o as l,c as t,ah as a}from"./chunks/framework.C4gM9MeL.js";const u=JSON.parse('{"title":"Tiled地图解析思路","description":"","frontmatter":{},"headers":[],"relativePath":"development/Tiled地图解析思路.md","filePath":"development/Tiled地图解析思路.md","lastUpdated":1771644166000}'),n={name:"development/Tiled地图解析思路.md"};function e(h,i,p,k,o,d){return l(),t("div",null,[...i[0]||(i[0]=[a(`<h1 id="tiled地图解析思路" tabindex="-1">Tiled地图解析思路 <a class="header-anchor" href="#tiled地图解析思路" aria-label="Permalink to &quot;Tiled地图解析思路&quot;">​</a></h1><ul><li><p>获取tilesets数组并载入图块集的数据</p></li><li><p>获取layers数组并遍历对象</p><ul><li><p>如果 type : imagelayer，载入单一图片</p><ul><li>关注&quot;parallax&quot;,&quot;repeat&quot;,&quot;offset&quot;字段</li><li>创建包含 ParallaxComponent 的游戏对象</li></ul></li><li><p>如果 type : tilelayer，载入瓦片层</p><ul><li>总共有“地图大小”个瓦片，放入容器vector中</li><li>每个瓦片包含数据：Sprite，Type(例如solid类型)</li><li>可能引用多个图块集，因此可先<em>载入并保存每个图块集的数据</em>（载入函数），其它瓦片层(以及对象层)也能继续引用</li><li>通过data数组中的gid查找所需信息（查找函数，能获取自定义属性），填充瓦片vector</li><li>创建包含 TileLayerComponent 的游戏对象(持有瓦片vector)</li></ul></li><li><p>如果 type : objectgroup 载入对象层</p><ul><li>对象数据在&quot;objects&quot;字段中，每个对象都创建一个游戏对象</li><li>关注的要点：gid查找<strong>源图片信息</strong>，layer数据中确认目标位置（TransformComponent）信息 <ul><li>源图片信息：如果是&quot;solid&quot;类型，则 为静止障碍物，碰撞盒大小为整个图片大小</li><li>源图片信息：如果非&quot;solid&quot;类型，则 <ul><li>碰撞盒大小、偏移: 获取 &quot;objectgroup&quot; --&gt; 获取 &quot;objects&quot; --&gt; &quot;x&quot;,&quot;y&quot;,&quot;width&quot;,&quot;height&quot;</li><li>获取其他指定自定义属性（模版函数），进行必要设置/组件添加。（例如tag、gravity）</li></ul></li><li>源图片信息：如果有&quot;animation&quot;字段（自定义），则载入动画信息并创建动画组件 <ul><li>必要讯息（自定义）：动画名称、每一帧的源矩形、帧持续时间。</li></ul></li></ul></li><li>如果没有gid，则代表自己绘制的形状（可能是碰撞盒、触发器等，未来按需处理）</li></ul></li></ul></li><li><p>自定义属性的获取方法：图块集中 获取 &quot;tiles&quot; --&gt; 获取 &quot;properties&quot;</p></li><li><p><strong>对象层物体特别注意:</strong> 信息分散在两个区块中：</p><ul><li>地图tmj中： 绘制区域、名字 (及针对当前地图添加的自定义属性)</li><li>gid对应的图块集tsj中: 源图片信息 (画在任何地图上都会有的属性)</li></ul></li></ul><h1 id="地图自定义属性约定" tabindex="-1">地图自定义属性约定 <a class="header-anchor" href="#地图自定义属性约定" aria-label="Permalink to &quot;地图自定义属性约定&quot;">​</a></h1><ul><li><p>限瓦片层</p><ul><li>unisolid (bool) : 单向平台</li><li>ladder (bool) : 梯子</li><li>slope (string) : 斜坡图块，格式&quot;x_y&quot;。x表示左边高度，y表示右边高度。范围0~1。（如果是2则表示1/2高度）</li></ul></li><li><p>限对象层</p><ul><li>tag (string) : 对象类型，例如player,enemy,item</li><li>gravity (bool) : 是否使用重力（有此字段则默认添加 PhysicsComponent）</li><li>health (int) : 添加生命组件，生命值为 value</li><li>animation (json_string) : 添加动画组件，json格式为:<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;duration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;row&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;frames&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">array(int)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>含义为:<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;动画名&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;帧持续时间&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">ms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;行&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">(从</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">开始数)</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;帧序列（列）&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]} }</span></span></code></pre></div>要求每个动画序列帧必须在同一行。</li><li>sound (json_string) : 添加音频组件，json格式为:<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;file_path1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li>图块碰撞编辑器：识别为碰撞盒，限一个图形，只支持矩形和圆形</li><li>自定义形状：默认为触发器，两种主要功能 <ul><li><ol><li>进入下一关：tag : next_level，名称(Tiled自带字段)为下一关地图名字，例如 level2</li></ol></li><li><ol start="2"><li>游戏胜利：tag: win</li></ol></li></ul></li></ul></li><li><p>两层皆可</p><ul><li>solid (bool) : 静止不可进入的图块/物体</li><li>hazard (bool) : 对玩家造成伤害的瓦片</li></ul></li></ul>`,4)])])}const E=s(n,[["render",e]]);export{u as __pageData,E as default};
